<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Particle Playground</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #0a2e0a;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    canvas { display: block; }

    #ui {
      position: fixed;
      bottom: 28px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      align-items: center;
      background: rgba(255,255,255,0.07);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 40px;
      padding: 10px 20px;
      user-select: none;
    }

    .btn {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.15);
      color: #fff;
      padding: 7px 18px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.82rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      transition: background 0.15s, transform 0.1s;
      white-space: nowrap;
    }

    .btn:hover { background: rgba(255,255,255,0.2); }
    .btn:active { transform: scale(0.96); }
    .btn.active { background: rgba(255,255,255,0.3); border-color: rgba(255,255,255,0.4); }

    .divider {
      width: 1px;
      height: 24px;
      background: rgba(255,255,255,0.15);
    }

    #hint {
      position: fixed;
      top: 24px;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255,255,255,0.35);
      font-size: 0.8rem;
      letter-spacing: 0.05em;
      pointer-events: none;
      transition: opacity 1s;
    }
  </style>
</head>
<body>
  <canvas id="c"></canvas>

  <div id="hint">MOVE MOUSE · CLICK TO EXPLODE · SCROLL TO RESIZE</div>

  <div id="ui">
    <button class="btn active" id="btn-repel" onclick="setMode('repel', this)">Repel</button>
    <button class="btn" id="btn-attract" onclick="setMode('attract', this)">Attract</button>
    <button class="btn" id="btn-vortex" onclick="setMode('vortex', this)">Vortex</button>
    <div class="divider"></div>
    <button class="btn" onclick="explode()">Explode</button>
    <button class="btn" onclick="resetParticles()">Reset</button>
    <div class="divider"></div>
    <button class="btn" id="btn-trails" onclick="toggleTrails(this)">Trails: Off</button>
  </div>

  <script>
    const canvas = document.getElementById('c');
    const ctx    = canvas.getContext('2d');

    let W, H;
    let mouse = { x: -9999, y: -9999, down: false };
    let mode   = 'repel';
    let trails = false;
    let radius = 120;

    const N = 800;
    const particles = [];

    const COLORS = [
      '#ff6b6b','#ff8e53','#ffd93d',
      '#6bcb77','#4d96ff','#c77dff','#ff6bef'
    ];

    function resize() {
      W = canvas.width  = window.innerWidth;
      H = canvas.height = window.innerHeight;
    }

    class Particle {
      constructor(x, y) {
        this.x  = x  ?? Math.random() * W;
        this.y  = y  ?? Math.random() * H;
        this.ox = this.x;
        this.oy = this.y;
        this.vx = (Math.random() - 0.5) * 2;
        this.vy = (Math.random() - 0.5) * 2;
        this.size   = Math.random() * 2.5 + 1;
        this.color  = COLORS[Math.floor(Math.random() * COLORS.length)];
        this.mass   = this.size;
        this.alpha  = Math.random() * 0.5 + 0.5;
      }

      update() {
        const dx   = mouse.x - this.x;
        const dy   = mouse.y - this.y;
        const dist = Math.sqrt(dx * dx + dy * dy) || 1;

        if (dist < radius) {
          const force = (radius - dist) / radius;
          const angle = Math.atan2(dy, dx);

          if (mode === 'repel') {
            this.vx -= Math.cos(angle) * force * 2.5;
            this.vy -= Math.sin(angle) * force * 2.5;
          } else if (mode === 'attract') {
            this.vx += Math.cos(angle) * force * 2;
            this.vy += Math.sin(angle) * force * 2;
          } else if (mode === 'vortex') {
            this.vx += -Math.sin(angle) * force * 2.5;
            this.vy +=  Math.cos(angle) * force * 2.5;
          }
        }

        // Soft return to origin
        this.vx += (this.ox - this.x) * 0.003;
        this.vy += (this.oy - this.y) * 0.003;

        // Friction
        this.vx *= 0.92;
        this.vy *= 0.92;

        this.x += this.vx;
        this.y += this.vy;

        // Bounce off walls
        if (this.x < 0)  { this.x = 0;  this.vx *= -0.6; }
        if (this.x > W)  { this.x = W;  this.vx *= -0.6; }
        if (this.y < 0)  { this.y = 0;  this.vy *= -0.6; }
        if (this.y > H)  { this.y = H;  this.vy *= -0.6; }
      }

      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.globalAlpha = this.alpha;
        ctx.fill();
        ctx.globalAlpha = 1;
      }
    }

    function resetParticles() {
      particles.length = 0;
      for (let i = 0; i < N; i++) particles.push(new Particle());
    }

    function explode() {
      const cx = W / 2, cy = H / 2;
      particles.forEach(p => {
        const angle = Math.atan2(p.y - cy, p.x - cx);
        const power = Math.random() * 20 + 10;
        p.vx = Math.cos(angle) * power;
        p.vy = Math.sin(angle) * power;
      });
    }

    function setMode(m, btn) {
      mode = m;
      document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }

    function toggleTrails(btn) {
      trails = !trails;
      btn.textContent = `Trails: ${trails ? 'On' : 'Off'}`;
      if (trails) btn.classList.add('active'); else btn.classList.remove('active');
    }

    function drawConnections() {
      const maxDist = 80;
      for (let i = 0; i < particles.length; i++) {
        for (let j = i + 1; j < particles.length; j++) {
          const a = particles[i], b = particles[j];
          const dx = a.x - b.x, dy = a.y - b.y;
          const d  = Math.sqrt(dx*dx + dy*dy);
          if (d < maxDist) {
            ctx.beginPath();
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
            ctx.strokeStyle = a.color;
            ctx.globalAlpha = (1 - d / maxDist) * 0.25;
            ctx.lineWidth = 0.5;
            ctx.stroke();
            ctx.globalAlpha = 1;
          }
        }
      }
    }

    function loop() {
      if (trails) {
        ctx.fillStyle = 'rgba(10,46,10,0.18)';
        ctx.fillRect(0, 0, W, H);
      } else {
        ctx.fillStyle = '#0a2e0a';
        ctx.fillRect(0, 0, W, H);
      }

      drawConnections();
      particles.forEach(p => { p.update(); p.draw(); });

      // Mouse glow
      if (mouse.x > 0) {
        const g = ctx.createRadialGradient(mouse.x, mouse.y, 0, mouse.x, mouse.y, radius);
        g.addColorStop(0, 'rgba(255,255,255,0.06)');
        g.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(mouse.x, mouse.y, radius, 0, Math.PI * 2);
        ctx.fill();
      }

      requestAnimationFrame(loop);
    }

    // Events
    window.addEventListener('resize', resize);

    window.addEventListener('mousemove', e => {
      mouse.x = e.clientX;
      mouse.y = e.clientY;
    });

    window.addEventListener('click', e => {
      // Burst from click point
      const cx = e.clientX, cy = e.clientY;
      particles.forEach(p => {
        const dx = p.x - cx, dy = p.y - cy;
        const dist = Math.sqrt(dx*dx + dy*dy) || 1;
        if (dist < 200) {
          const power = (200 - dist) / 200 * 15;
          const angle = Math.atan2(dy, dx);
          p.vx += Math.cos(angle) * power;
          p.vy += Math.sin(angle) * power;
        }
      });
    });

    window.addEventListener('wheel', e => {
      radius = Math.max(40, Math.min(300, radius - e.deltaY * 0.3));
    });

    // Fade hint
    setTimeout(() => { document.getElementById('hint').style.opacity = 0; }, 3000);

    resize();
    resetParticles();
    loop();
  </script>
</body>
</html>
